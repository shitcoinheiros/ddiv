<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="DDVF √© o diret√≥rio digital dos vistoriadores fotogr√°ficos o lugar aonde reguladoras, vistoriadoras empresas de inspetoria de sinistros encontra profissionais para a sua demanda de servi√ßo." />

    <title>DDFV</title>

    <!-- Basic Page Information -->
    <meta name="description" content="DDVF √© o diret√≥rio digital dos vistoriadores fotogr√°ficos o lugar aonde reguladoras, vistoriadoras empresas de inspetoria de sinistros encontra profissionais para a sua demanda de servi√ßo." />
    <meta name="keywords" content="DDVF √© o diret√≥rio digital dos vistoriadores fotogr√°ficos o lugar aonde reguladoras, vistoriadoras empresas de inspetoria de sinistros encontra profissionais para a sua demanda de servi√ßo." />

    <!-- Open Graph Meta Tags (for social sharing) -->
    <meta property="og:title" content="DDVF - Diret√≥rio digital dos vistoriadores fotogr√°ficos do Brasil." />
    <meta property="og:description" content="DDVF √© o diret√≥rio digital dos vistoriadores fotogr√°ficos o lugar aonde reguladoras, vistoriadoras empresas de inspetoria de sinistros encontra profissionais para a sua demanda de servi√ßo." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.ddvf.org" />
    <meta property="og:image" content="https://i.postimg.cc/1XH3dmb2/vistoria-fotogr-fica-logo-removebg-preview.png" />
    <meta property="og:image:alt" content="ddvf.org" />

    <!-- Twitter Meta Tags (for Twitter Cards) -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="DDVF - Diret√≥rio digital dos vistoriadores fotogr√°ficos do Brasil." />
    <meta name="twitter:description" content="DDVF √© o diret√≥rio digital dos vistoriadores fotogr√°ficos do Brasil o lugar aonde reguladoras, vistoriadoras empresas de inspetoria de sinistros encontra profissionais para a sua demanda de servi√ßo." />
    <meta name="twitter:image" content="https://i.postimg.cc/1XH3dmb2/vistoria-fotogr-fica-logo-removebg-preview.png" />

    <!-- Additional Meta Information -->
    <meta name="author" content="DDVF - Diret√≥rio digital dos vistoriadores fotogr√°ficos do Brasil" />
    <meta name="robots" content="index, follow" />

    <!-- Favicon -->
    <link rel="icon" href="https://i.postimg.cc/1XH3dmb2/vistoria-fotogr-fica-logo-removebg-preview.png" type="image/x-icon" />

    <!-- Stylesheet (link to your CSS file) -->
    <meta name="theme-color" content="#000000" />

    <!-- Canonical Link (if needed) -->
    <link rel="canonical" href="https://www.ddvf.org" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

    <link rel="stylesheet" type="text/css" href="style.css" />
    
    <style>
        /* Bot√µes de login/logout com texto */
        .login-btn,
        .logout-btn {
            background: transparent;
            border: none;
            padding: 8px 16px;
            margin-left: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        /* Bot√£o Entrar - Verde */
        .login-btn {
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }

        .login-btn:hover {
            background-color: #4CAF50;
            color: white;
        }

        /* Bot√£o Sair - Vermelho */
        .logout-btn {
            color: #f44336;
            border: 2px solid #f44336;
        }

        .logout-btn:hover {
            background-color: #f44336;
            color: white;
        }

        .navbar-links li a i {
            margin-right: 8px;
        }

        .navbar-links li {
            list-style: none;
        }
        
        /* Overlay de carregamento */
        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }
        
        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Cards container */
        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .card-content {
            padding: 20px;
        }
        
        .verification-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #4CAF50;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .contato-bloqueado {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .btn-login {
            background: #1a237e;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-left">
            <div class="navbar-logo">
                <img src="https://i.postimg.cc/1XH3dmb2/vistoria-fotogr-fica-logo-removebg-preview.png" alt="DFV"/>
            </div>
            <div class="navbar-title">DDVF</div>
        </div>

        <div class="navbar-hamburger">&#9776;</div>
        <ul class="navbar-links">
            <br />
            <li><a href="index.html">Inicio</a></li>
            <li><a href="cadastro.html" id="cadastroLink">Cadastre-se</a></li>
            <li><a href="buscar.html">Buscar Vistoriador</a></li>
            <li><a href="clube.html">Clube</a></li>
            <li><a href="duvidas.html">D√∫vidas</a></li>
            <li><a href="contato.html">Contato</a></li>
            
            <!-- Item de logout (inicialmente escondido) -->
            <li id="logoutItem" style="display: none;">
                <a href="#" onclick="logout(); return false;" class="logout-btn">
                    Sair
                </a>
            </li>

            <!-- Item de login (mostrado quando n√£o est√° logado) -->
            <li id="loginItem">
                <a href="#" onclick="abrirModal(); return false;" class="login-btn">
                    Entrar
                </a>
            </li>
        </ul>
    </nav>

    <link rel="stylesheet" href="style.css">

    <script>
        const hamburger = document.querySelector(".navbar-hamburger");
        const navbarLinks = document.querySelector(".navbar-links");

        hamburger.addEventListener("click", () => {
            navbarLinks.classList.toggle("active");
        });
    </script>
    
    <div>
        <div class="marquee-container">
            <div class="marquee">
                <br />
                <p>
                    DDVF - Diret√≥rio digital dos vistoriadores fotogr√°ficos do Brasil ‚öô Vistoriador, fa√ßa o seu cadastro para encontrar oportunidades ‚öô Empresas encontre o seu profissional aqui.
                </p>
            </div>
        </div>
    </div>
    <br />

    <br>
    <center>
        Pesquisar por estado:
        <br>
        <br>
        <label for="estadoSelect"> </label>
        <select id="estadoSelect">
            <option value="">Selecionar</option>
            <option value="AP">Amap√°</option>
            <option value="BA">Bahia</option>
            <option value="ES">Esp√≠rito Santo</option>
            <option value="GO">Goi√°s</option>
            <option value="MT">Mato Grosso</option>
            <option value="MS">Mato Grosso do Sul</option>
            <option value="MG">Minas Gerais</option>
            <option value="PR">Paran√°</option>
            <option value="RJ">Rio de Janeiro</option>
            <option value="RS">Rio Grande do Sul</option>
            <option value="RO">Rond√¥nia</option>
            <option value="SC">Santa Catarina</option>
            <option value="SP">S√£o Paulo</option>
            <option value="DF">Distrito Federal</option>
        </select>

        <button onclick="buscarEstado()">Buscar</button>
    </center>
    
    <!-- Sobreposi√ß√£o e Spinner -->
    <div id="overlay">
        <div class="spinner"></div>
        <p style="color: white; font-size: 18px;">Carregando vistoriadores...</p>
    </div>
    
    <br>
    <br>
    <div id="cards-container">
        <!-- Aqui ser√£o exibidos os cards filtrados -->
        <div class="instrucao" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
            <i class="fas fa-map-marker-alt" style="font-size: 48px; color: #666; margin-bottom: 20px;"></i>
            <h3>Selecione um estado acima</h3>
            <p>Escolha um estado para ver os vistoriadores dispon√≠veis na regi√£o</p>
        </div>
    </div>
    <br>
    <br>

    <br>
    <br>
    <br>
    
    <footer>
        <div class="redes-sociais">
            <div class="container">
                <p>
                    &copy;Todos os direitos reservados / DDVF 2024
                </p>
            </div>
        </div>
    </footer>

    <!-- MODAL HTML -->
    <div id="modalLogin" onclick="fecharModal()">
        <div class="modal-card" onclick="event.stopPropagation()">
            <div class="modal-content">
                <!-- Cabe√ßalho com logo centralizado -->
                <div class="modal-header">
                    <div class="modal-logo"></div>
                    <h2>Acessar Sistema</h2>
                </div>
                
                <!-- Formul√°rio de Login (sempre vis√≠vel inicialmente) -->
                <form id="formLogin">
                    <div class="form-group">
                        <input type="email" id="loginEmail" placeholder="Email">
                    </div>
                    <div class="form-group">
                        <input type="password" id="loginSenha" placeholder="Senha">
                    </div>
                    <div class="erro" id="loginErro"></div>
                    <center>
                        <button type="button" class="btn-primary" onclick="loginFirebase()">Entrar</button>
                    </center>
                    <div class="switch-link" onclick="mostrarCadastro()">
                        N√£o tem conta? <span>Cadastre-se</span>
                    </div>
                </form>
                
                <!-- Formul√°rio de Cadastro (inicialmente oculto) -->
                <form id="formCadastro" style="display: none;">
                    <div class="form-group">
                        <input type="text" id="cadEmpresa" placeholder="Nome da Empresa">
                    </div>
                    <div class="form-group">
                        <input type="text" id="cadCnpj" placeholder="CNPJ (apenas n√∫meros)" 
                               oninput="this.value = this.value.replace(/\D/g, '')">
                    </div>
                    <div class="form-group">
                        <input type="email" id="cadEmail" placeholder="Email">
                    </div>
                    <div class="form-group">
                        <input type="password" id="cadSenha" placeholder="Senha">
                    </div>
                    <div class="form-group">
                        <input type="password" id="cadConfirmar" placeholder="Confirmar Senha">
                    </div>
                    <div class="erro" id="cadErro"></div>
                    <center>
                        <button type="button" class="btn-primary" onclick="cadastrarUsuario()">Cadastrar</button>
                    </center>
                    <div class="switch-link" onclick="mostrarLogin()">
                        J√° tem conta? <span>Fa√ßa login</span>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- SCRIPT √öNICO E UNIFICADO -->
    <script type="module">
        /* ===============================
           üî• IMPORTS FIREBASE
        =============================== */
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import {
            getAuth,
            signInWithEmailAndPassword,
            createUserWithEmailAndPassword,
            onAuthStateChanged,
            signOut
        } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

        import {
            getFirestore,
            doc,
            setDoc
        } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        /* ===============================
           üîß CONFIG FIREBASE
        =============================== */
        const firebaseConfig = {
            apiKey: "AIzaSyC5vn2A781Kf5IGxxULRe_PVpViXbGGdzE",
            authDomain: "octolusco.firebaseapp.com",
            projectId: "octolusco",
            storageBucket: "octolusco.firebasestorage.app",
            messagingSenderId: "226020419549",
            appId: "1:226020419549:web:b5bb13be6dc7e29337f834",
            measurementId: "G-PLDK083FV8"
        };

        /* ===============================
           üöÄ INIT
        =============================== */
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.usuarioLogado = false;

        /* ===============================
           üìä DADOS DOS VISTORIADORES
        =============================== */
        const dadosVistoriadores = {
            "cards": [
                {
                    "titulo": "",
                    "nome": "William Garcia ‚öô NR:007.2023",
                    "telefone": "(21)975279648",
                    "email": "horus.inspetoria@gmail.com",
                    "especialidades": "Regula√ß√£o de sinistros, vistorias de desmobiliza√ß√£o, pr√©via, ramos elementares, constata√ß√£o, im√≥veis e mais.",
                    "area": "Teres√≥polis.",
                    "estado": "RJ",
                    "imagem": "https://lh3.googleusercontent.com/a/ACg8ocK1_7DgQrOzDmXyiqNCdXKsO3Xpl8Wf47BIIVq5jxpTR3Q=s260-c-no",
                    "verificado": true
                },
                {
                    "titulo": "",
                    "nome": "Fabricio Abreu ‚öô NR:026.2023",
                    "telefone": "(22)997837643",
                    "email": "famape1800@gmail.com",
                    "especialidades": "Regula√ß√£o de sinistros, vistorias de desmobiliza√ß√£o, pr√©via, ramos elementares, constata√ß√£o, im√≥veis e mais.",
                    "area": "Regi√£o dos Lagos, Maca√© e Campos dos Goytacazes.",
                    "estado": "RJ",
                    "imagem": "https://i.postimg.cc/7h6qjKrX/IMG-20231217-153245116.jpg",
                    "verificado": false
                },
                {
                    "titulo": "",
                    "nome": "Marcio Costa ‚öô NR:008.2025",
                    "telefone": "(21)969916718",
                    "email": "marciocosta77@live.com",
                    "especialidades": "Regula√ß√£o de sinistros, vistorias de desmobiliza√ß√£o, pr√©via, ramos elementares, constata√ß√£o, im√≥veis e mais.",
                    "area": "Rio de Janeiro.",
                    "estado": "RJ",
                    "imagem": "https://i.postimg.cc/j5vJ3Pz3/inbound1307297000303089178.jpg",
                    "verificado": false
                },
                // Adicione todos os outros cards aqui seguindo o mesmo padr√£o
                // ... (coloque todo o seu JSON aqui)
                {
                    "titulo": "",
                    "nome": "Mauro Toneto ‚öô NR:007.2025",
                    "telefone": "(69)992466804",
                    "email": "mauromackert@gmail.com",
                    "especialidades": "Regula√ß√£o de sinistros, vistorias de desmobiliza√ß√£o, pr√©via, ramos elementares, constata√ß√£o, im√≥veis e mais.",
                    "area": "Jaru e Adjac√™ncias.",
                    "estado": "RO",
                    "imagem": "https://i.postimg.cc/jSs3RB2z/inbound8824273639350211215.jpg",
                    "verificado": false
                }
            ]
        };

        /* ===============================
           üîç BUSCAR POR ESTADO
        =============================== */
        window.buscarEstado = async function () {
            const estadoSelecionado = document.getElementById('estadoSelect').value;
            
            if (!estadoSelecionado) {
                alert('Por favor, selecione um estado.');
                return;
            }
            
            // Verifica se est√° logado
            const user = auth.currentUser;
            if (!user && estadoSelecionado) {
                // Se n√£o est√° logado mas selecionou um estado, mostra os cards sem contato
                const cardsFiltrados = dadosVistoriadores.cards.filter(card => card.estado === estadoSelecionado);
                exibirCards(cardsFiltrados);
                return;
            }
            
            // Mostra overlay de carregamento
            document.getElementById('overlay').style.display = 'flex';
            
            // Simula um delay (pode remover se quiser mais r√°pido)
            setTimeout(() => {
                const cardsFiltrados = dadosVistoriadores.cards.filter(card => card.estado === estadoSelecionado);
                exibirCards(cardsFiltrados);
                document.getElementById('overlay').style.display = 'none';
            }, 1000);
        };

        /* ===============================
           üé¥ EXIBIR CARDS
        =============================== */
        function exibirCards(cardsParaExibir) {
            const cardsContainer = document.getElementById('cards-container');
            
            if (!cardsParaExibir || cardsParaExibir.length === 0) {
                cardsContainer.innerHTML = `
                    <div class="instrucao" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <i class="fas fa-search" style="font-size: 48px; color: #666; margin-bottom: 20px;"></i>
                        <h3>Nenhum vistoriador encontrado</h3>
                        <p>N√£o h√° vistoriadores cadastrados para este estado no momento.</p>
                        <p>Tente selecionar outro estado.</p>
                    </div>
                `;
                return;
            }
            
            cardsContainer.innerHTML = '';
            
            cardsParaExibir.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.classList.add('card');
                
                // IMAGEM
                const imagemElement = document.createElement('img');
                imagemElement.src = card.imagem;
                imagemElement.alt = `Foto de ${card.nome}`;
                imagemElement.onerror = function() {
                    this.src = 'https://via.placeholder.com/300x200/1a237e/ffffff?text=Sem+Imagem';
                };
                cardElement.appendChild(imagemElement);
                
                // VERIFICADO
                if (card.verificado) {
                    const verificationBadge = document.createElement('div');
                    verificationBadge.classList.add('verification-badge');
                    verificationBadge.innerHTML = '<i class="fas fa-check"></i>';
                    cardElement.appendChild(verificationBadge);
                }
                
                const cardContent = document.createElement('div');
                cardContent.classList.add('card-content');
                
                // T√çTULO
                const tituloElement = document.createElement('h4');
                tituloElement.textContent = 'Vistoriador Credenciado';
                cardContent.appendChild(tituloElement);
                
                // NOME
                const nomeElement = document.createElement('p');
                nomeElement.innerHTML = `<strong>Nome:</strong> ${card.nome}`;
                cardContent.appendChild(nomeElement);
                
                // CONTATOS (com controle de acesso)
                const user = auth.currentUser;
                if (user) {
                    // Usu√°rio logado: mostra telefone e email
                    const telefoneElement = document.createElement('p');
                    telefoneElement.innerHTML = `<strong>Telefone:</strong> <a href="tel:${card.telefone.replace(/\D/g, '')}">${card.telefone}</a>`;
                    cardContent.appendChild(telefoneElement);
                    
                    const emailElement = document.createElement('p');
                    emailElement.innerHTML = `<strong>E-mail:</strong> <a href="mailto:${card.email}">${card.email}</a>`;
                    cardContent.appendChild(emailElement);
                } else {
                    // Usu√°rio n√£o logado: mostra bloqueado
                    const bloqueado = document.createElement('div');
                    bloqueado.classList.add('contato-bloqueado');
                    bloqueado.innerHTML = `
                        <i class="fas fa-lock"></i>
                        <p><strong>Contato restrito</strong></p>
                        <p>Fa√ßa login para ver telefone e e-mail</p>
                        <button class="btn-login" onclick="abrirModal()">Entrar</button>
                    `;
                    cardContent.appendChild(bloqueado);
                }
                
                // ESPECIALIDADES
                const especialidadesElement = document.createElement('p');
                especialidadesElement.innerHTML = `<strong>Especialidades:</strong> ${card.especialidades}`;
                cardContent.appendChild(especialidadesElement);
                
                // √ÅREA
                const areaElement = document.createElement('p');
                areaElement.innerHTML = `<strong>√Årea de Atua√ß√£o:</strong> ${card.area}`;
                cardContent.appendChild(areaElement);
                
                // ESTADO
                const estadoElement = document.createElement('p');
                estadoElement.innerHTML = `<strong>Estado:</strong> ${card.estado}`;
                cardContent.appendChild(estadoElement);
                
                // LOGO
                const logoElement = document.createElement('div');
                logoElement.style.height = '30px';
                logoElement.style.background = 'url(https://i.postimg.cc/1XH3dmb2/vistoria-fotogr-fica-logo-removebg-preview.png) no-repeat center';
                logoElement.style.backgroundSize = 'contain';
                logoElement.style.marginTop = '15px';
                logoElement.style.opacity = '0.7';
                cardContent.appendChild(logoElement);
                
                cardElement.appendChild(cardContent);
                cardsContainer.appendChild(cardElement);
            });
        }

        /* ===============================
           üîí LOGOUT FUNCTION
        =============================== */
        window.logout = async function () {
            try {
                await signOut(auth);
                // O onAuthStateChanged vai atualizar a interface automaticamente
                alert('Logout realizado com sucesso!');
            } catch (error) {
                console.error("Erro ao fazer logout:", error);
                alert("Erro ao fazer logout. Tente novamente.");
            }
        };

        /* ===============================
           üëÄ OBSERVA LOGIN
        =============================== */
        onAuthStateChanged(auth, (user) => {
            window.usuarioLogado = !!user;
            const usuarioLogadoElement = window.usuarioLogado;

            // Atualizar menu de navega√ß√£o
            const logoutItem = document.getElementById("logoutItem");
            const loginItem = document.getElementById("loginItem");
            const cadastroLink = document.getElementById("cadastroLink");
            
            if (user) {
                // Usu√°rio logado: mostrar "Sair", esconder "Entrar"
                if (logoutItem) logoutItem.style.display = "block";
                if (loginItem) loginItem.style.display = "none";
                
                // Atualizar op√ß√£o de cadastro para perfil (opcional)
                if (cadastroLink) {
                    cadastroLink.innerHTML = '<i class="fas fa-user"></i> Meu Perfil';
                    cadastroLink.href = "#";
                    cadastroLink.onclick = function(e) {
                        e.preventDefault();
                        alert("P√°gina de perfil em desenvolvimento!");
                    };
                }
                
                fecharModal();
                
                // Se tem um estado selecionado, recarrega os cards
                const estadoSelecionado = document.getElementById('estadoSelect').value;
                if (estadoSelecionado) {
                    buscarEstado();
                }
            } else {
                // Usu√°rio n√£o logado: mostrar "Entrar", esconder "Sair"
                if (logoutItem) logoutItem.style.display = "none";
                if (loginItem) loginItem.style.display = "block";
                
                // Restaurar op√ß√£o de cadastro
                if (cadastroLink) {
                    cadastroLink.innerHTML = 'Cadastre-se';
                    cadastroLink.href = "cadastro.html";
                    cadastroLink.onclick = null;
                }
                
                // Se tem um estado selecionado, recarrega os cards sem contato
                const estadoSelecionado = document.getElementById('estadoSelect').value;
                if (estadoSelecionado) {
                    buscarEstado();
                }
            }
        });

        /* ===============================
           üîë LOGIN
        =============================== */
        window.loginFirebase = async function () {
            const email = document.getElementById("loginEmail")?.value;
            const senha = document.getElementById("loginSenha")?.value;
            const erro = document.getElementById("loginErro");

            if (!email || !senha) {
                if (erro) erro.innerText = "Preencha email e senha";
                return;
            }

            try {
                await signInWithEmailAndPassword(auth, email, senha);
                // Login bem-sucedido - o onAuthStateChanged ir√° fechar o modal automaticamente
            } catch (error) {
                if (erro) {
                    if (error.code === 'auth/invalid-email') {
                        erro.innerText = "Email inv√°lido";
                    } else if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                        erro.innerText = "Email ou senha inv√°lidos";
                    } else {
                        erro.innerText = "Erro ao fazer login";
                    }
                }
            }
        };

        /* ===============================
           üÜï CADASTRO
        =============================== */
        window.cadastrarUsuario = async function () {
            const empresa = document.getElementById("cadEmpresa")?.value;
            const cnpj = document.getElementById("cadCnpj")?.value;
            const email = document.getElementById("cadEmail")?.value;
            const senha = document.getElementById("cadSenha")?.value;
            const confirmar = document.getElementById("cadConfirmar")?.value;
            const erro = document.getElementById("cadErro");

            if (!empresa || !cnpj || !email || !senha || !confirmar) {
                if (erro) erro.innerText = "Preencha todos os campos";
                return;
            }

            if (cnpj.replace(/\D/g, "").length !== 14) {
                if (erro) erro.innerText = "CNPJ inv√°lido (14 d√≠gitos)";
                return;
            }

            if (senha !== confirmar) {
                if (erro) erro.innerText = "As senhas n√£o conferem";
                return;
            }

            if (senha.length < 6) {
                if (erro) erro.innerText = "A senha deve ter pelo menos 6 caracteres";
                return;
            }

            try {
                const cred = await createUserWithEmailAndPassword(auth, email, senha);

                await setDoc(doc(db, "usuarios", cred.user.uid), {
                    empresa,
                    cnpj,
                    email,
                    criadoEm: new Date()
                });

                if (erro) erro.innerText = "";
                // Cadastro bem-sucedido - o usu√°rio j√° estar√° logado automaticamente
            } catch (error) {
                if (erro) {
                    if (error.code === 'auth/email-already-in-use') {
                        erro.innerText = "Email j√° cadastrado";
                    } else if (error.code === 'auth/weak-password') {
                        erro.innerText = "Senha muito fraca";
                    } else if (error.code === 'auth/invalid-email') {
                        erro.innerText = "Email inv√°lido";
                    } else {
                        erro.innerText = "Erro ao cadastrar: " + error.message;
                    }
                }
            }
        };

        /* ===============================
           ü™ü MODAL FUNCTIONS
        =============================== */
        window.abrirModal = function () {
            const modal = document.getElementById("modalLogin");
            if (!modal) {
                console.error("modalLogin n√£o encontrado no HTML");
                return;
            }
            
            // Resetar para estado inicial
            mostrarLogin();
            document.getElementById("loginErro").innerText = "";
            document.getElementById("cadErro").innerText = "";
            
            // Limpar campos
            document.getElementById("loginEmail").value = "";
            document.getElementById("loginSenha").value = "";
            document.getElementById("cadEmpresa").value = "";
            document.getElementById("cadCnpj").value = "";
            document.getElementById("cadEmail").value = "";
            document.getElementById("cadSenha").value = "";
            document.getElementById("cadConfirmar").value = "";
            
            modal.style.display = "flex";
        };

        window.fecharModal = function () {
            const modal = document.getElementById("modalLogin");
            if (!modal) return;
            modal.style.display = "none";
        };

        window.mostrarCadastro = function () {
            const login = document.getElementById("formLogin");
            const cadastro = document.getElementById("formCadastro");
            
            if (!login || !cadastro) return;

            login.style.display = "none";
            cadastro.style.display = "block";
        };

        window.mostrarLogin = function () {
            const login = document.getElementById("formLogin");
            const cadastro = document.getElementById("formCadastro");
            
            if (!login || !cadastro) return;

            cadastro.style.display = "none";
            login.style.display = "block";
        };
    </script>
</body>
</html>
